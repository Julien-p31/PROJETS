# Tutoriel : Analyser un malware pour comprendre son comportement

## 🎯 Objectif  
Apprendre à pratiquer l’analyse malware (statique, dynamique, hybride), isoler un échantillon, l’exécuter en sandbox, extraire indicateurs, et générer un rapport actionnable.

## 🧠 Scénario d’ancrage émotionnel  
Un malware inconnu infecte un système sensible. En tant qu’analyste SOC, vous devez reproduire l’environnement et comprendre chaque action malveillante pour anticiper une éventuelle fuite de données.

---

## 🛠️ Prérequis  
- Machine dédiée ou VM (idéalement deux : analyseur + sandbox isolée)  
- Outils OS : Linux/Windows  
- Environnement : FlareVM/REMnux ou sandbox type Cuckoo/ANY.RUN  
- Outils à installer : `Wireshark`, `Procmon`, `Volatility`, `Cuckoo Sandbox` ou `Limon`  [oai_citation:0‡blackhat.com](https://www.blackhat.com/docs/eu-15/materials/eu-15-KA-Automating-Linux-Malware-Analysis-Using-Limon-Sandbox-wp.pdf?utm_source=chatgpt.com) [oai_citation:1‡WebAsha](https://www.webasha.com/blog/dynamic-malware-analysis-checklist-tools-steps-guide?utm_source=chatgpt.com)

---

## 🧠 Étape 1 – Préparation de l’environnement isolé

1. Créez une VM « clean state » dédiée sandbox (snapshot initial)  
2. Montez Réseau isolé sans accès Internet réel (NAT simulé ou Netfilter)  
3. Installez outils : analyse fichiers (PEiD, FLOSS), dynamic (Procmon, Cuckoo)  [oai_citation:2‡GitHub](https://github.com/Logeshwar-S/Malware-Analysis-Sandbox?utm_source=chatgpt.com)  
Visualisez le workflow d’analyse : extraction, exécution, collecte, classification  [oai_citation:3‡ResearchGate](https://www.researchgate.net/figure/Malware-analysis-methodology_fig1_370399616?utm_source=chatgpt.com)

---

## 🧩 Étape 2 – Analyse statique

- Inspectez en ouvrant le binaire (PE Header, strings)  
- Détectez packers, imports suspects (`CreateProcess`, `LoadLibrary`)  [oai_citation:4‡GeeksforGeeks](https://www.geeksforgeeks.org/software-engineering/introduction-to-malware-analysis/?utm_source=chatgpt.com)  
- Utilisez des signatures YARA pour reconnaissance rapide

---

## 🧩 Étape 3 – Analyse dynamique

1. Prenez snapshot initial  
2. Lancez Procmon, Wireshark, Regshot, Volatility sur VM  
3. Exécutez le malware  
4. Arrêtez et prenez snapshot final  
5. Comparez changements système : fichiers, registres, processus  [oai_citation:5‡SlideTeam](https://www.slideteam.net/dynamic-malware-analysis-flow-chart.html?utm_source=chatgpt.com) [oai_citation:6‡WebAsha](https://www.webasha.com/blog/dynamic-malware-analysis-checklist-tools-steps-guide?utm_source=chatgpt.com) [oai_citation:7‡ResearchGate](https://www.researchgate.net/figure/Dynamic-malware-analysis-flowchart_fig1_323571589?utm_source=chatgpt.com) [oai_citation:8‡ResearchGate](https://www.researchgate.net/figure/Malware-analysis-methodology_fig1_370399616?utm_source=chatgpt.com)  
6. Analysez trafic réseau (C2, DNS), injections malveillantes ()

---

## 🧩 Étape 4 – Extraction d’IOCs

- Fichiers créés/modifiés  
- Entrées registre suspectes  
- IP/C2/DNS malveillantes  
- Processus/payload injectés  
Générez rapport CSV/XML pour ingestion SIEM

---

## 🧠 Étape 5 – Détection d’évasions & anti-analyse

- Recherchez : détection de VM, délais d’exécution, fingerprint sandbox ()  
- Documentez les techniques anti-VM (ex : lectures CPUID, timecheck)

---

## 🧩 Étape 6 – Analyse hybride

Combinez les résultats statiques et dynamiques pour classifier le malware (familly, type) ()  
Documentez signature ou règle YARA possible

---

## 🧪 Quiz de consolidation

1. Quels sont les avantages/inconvénients de l’analyse statique ?  
2. Que capture Wireshark pendant l’analyse ?  
3. Pourquoi utiliser Regshot + snapshot VM ?  
4. Citez une technique pour détecter la sandbox.  
5. Qu’est-ce qu’un IOC et à quoi sert-il ?

---

## ✅ Cas d’usage concrets

- Tri initial de samples suspects  
- Rétro ingénierie d’un exécutable malveillant  
- Génération de signatures pour votre antivirus interne

---

## 🔧 Extensions possibles

- Automatiser l’analyse avec Cuckoo ou Limon Sandbox  [oai_citation:9‡Difference Between](https://www.differencebetween.net/technology/difference-between-static-malware-analysis-and-dynamic-malware-analysis/?utm_source=chatgpt.com) [oai_citation:10‡WebAsha](https://www.webasha.com/blog/dynamic-malware-analysis-checklist-tools-steps-guide?utm_source=chatgpt.com) [oai_citation:11‡blackhat.com](https://www.blackhat.com/docs/eu-15/materials/eu-15-KA-Automating-Linux-Malware-Analysis-Using-Limon-Sandbox-wp.pdf?utm_source=chatgpt.com)  
- Intégrer Volatility pour extraction memory dump  
- Développer un scanner YARA basé IOCs

---

## 🎓 Résultat attendu

– Environnement sandbox propre et fonctionnel  
– Rapport complet d’analyse statique et comportementale  
– IOCs identifiés (fichiers, réseaux, registres)  
– Prototype de détection (YARA, sandbox automation)

---

### 📚 Sources & inspirations  
- Comparatif statique vs dynamique  [oai_citation:12‡WebAsha](https://www.webasha.com/blog/dynamic-malware-analysis-checklist-tools-steps-guide?utm_source=chatgpt.com) [oai_citation:13‡ANY.RUN](https://any.run/cybersecurity-blog/linux-malware-analysis-sandbox/?utm_source=chatgpt.com) [oai_citation:14‡infuse.quest](https://infuse.quest/en/learning-path/3/module-3/?utm_source=chatgpt.com) [oai_citation:15‡GeeksforGeeks](https://www.geeksforgeeks.org/software-engineering/introduction-to-malware-analysis/?utm_source=chatgpt.com) [oai_citation:16‡HackerCombat](https://www.hackercombat.com/static-malware-analysis-vs-dynamic-malware-analysis/?utm_source=chatgpt.com)  
- Workflow sandbox (Cuckoo, Limon, ANY.RUN)  [oai_citation:17‡ANY.RUN](https://any.run/cybersecurity-blog/linux-malware-analysis-sandbox/?utm_source=chatgpt.com)  
- Evasion malware & sandbox fingerprinting  [oai_citation:18‡arxiv.org](https://arxiv.org/abs/1811.01190?utm_source=chatgpt.com)

Ce tutoriel optimise la charge cognitive via progression claire, double codage (texte + schémas), segmentation active, et renforce par analogie (environnement virtuel vs sandbox).