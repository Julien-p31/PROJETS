# Tutoriel : Configurer des rÃ¨gles de pare-feu pour bloquer les menaces

## ğŸ¯ Objectif  
Mettre en place un pare-feu hÃ´te sous Linux pour filtrer le trafic entrant et sortant, bloquer les IP malveillantes, dÃ©tecter les activitÃ©s suspectes, et assurer une protection permanente.

## ğŸ§  ScÃ©nario dâ€™ancrage Ã©motionnel  
Vous gÃ©rez un serveur exposÃ© Ã  Internet. AprÃ¨s plusieurs tentatives dâ€™intrusion, vous formalisez des rÃ¨gles de pare-feu pour rÃ©duire lâ€™impact et sÃ©curiser votre environnement avant quâ€™un attaquant sÃ©rieux nâ€™en profite.

---

## ğŸ› ï¸ PrÃ©requis  
- Linux (Ubuntu/Debian) avec `sudo`  
- Outils installÃ©s :  
  ```bash
  sudo apt update
  sudo apt install ufw iptables fail2ban

	â€¢	AccÃ¨s root

â¸»

Ã‰tapeâ€¯1 â€“ DÃ©finir une politique par dÃ©faut (UFW)

sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw enable

	â€¢	EntrÃ©es bloquÃ©es par dÃ©faut, sorties autorisÃ©es
	â€¢	Active le journal pour audit ultÃ©rieur  ï¿¼ ï¿¼

â¸»

Ã‰tapeâ€¯2 â€“ Autoriser les services essentiels

sudo ufw allow ssh      # port 22
sudo ufw allow http     # port 80
sudo ufw allow https    # port 443

	â€¢	Exemple pour un serveur web + SSH
	â€¢	VÃ©rifiez les rÃ¨gles avec sudo ufw status verbose  ï¿¼

â¸»

Ã‰tapeâ€¯3 â€“ Bloquer une IP ou plage malveillante (rÃ©putation)
	â€¢	Bloquer une IP :

sudo ufw deny from 203.0.113.45

	â€¢	Bloquer une plage CIDR :

sudo ufw deny from 198.51.100.0/24

	â€¢	Pour plus de rÃ¨gles personnalisÃ©es, UFW repose sur iptables en arriÃ¨re-plan  ï¿¼ ï¿¼

â¸»

Ã‰tapeâ€¯4 â€“ GÃ©rer le logging (supervision)

sudo ufw logging on

ğŸ§© Log notable : /var/log/ufw.log
Aide Ã  dÃ©tecter scans, tentatives rÃ©pÃ©tÃ©es, IP non identifiÃ©es  ï¿¼ ï¿¼

â¸»

Ã‰tapeâ€¯5 â€“ Renforcer avec Fail2Ban (protection dynamique)

sudo apt install fail2ban

	â€¢	Activez le service :

# /etc/fail2ban/jail.local
[sshd]
enabled = true
maxretry = 5
bantime = 3600

	â€¢	RedÃ©marrez :

sudo systemctl restart fail2ban

â¡ï¸ Fail2Ban surveille /var/log/auth.log et bannit via iptables  ï¿¼

â¸»

Ã‰tapeâ€¯6 â€“ Ajouter des rÃ¨gles avancÃ©es en iptables

Pour rÃ¨gles complexes, par exemple bloquer IPs Tor :

sudo iptables -A INPUT -s <tor-ip-list> -j DROP
sudo iptables -A OUTPUT -d <tor-ip-list> -j DROP

	â€¢	Utiliser des flux de menaces dynamiques, tel que Tor exit nodes  ï¿¼ ï¿¼
	â€¢	IntÃ©grer ces rÃ¨gles via script ou systemd pour persistance ()

â¸»

ğŸ§  PiÃ¨ges Ã  Ã©viter
	â€¢	ğŸ”‘ Ne pas bloquer tous les ports dâ€™un coup : risque de vous verrouiller
	â€¢	âŒ Oublier la version IPv6 : UFW active souvent IPv6 par dÃ©faut  ï¿¼
	â€¢	ğŸŒ€ Ne jamais mÃ©langer trop de rÃ¨gles iptables directes sans ordre cohÃ©rent (UFw + iptables)  ï¿¼

â¸»

ğŸ§ª Quiz de consolidation
	1.	Que fait ufw default deny incoming ?
	2.	OÃ¹ voir les tentatives bloquÃ©es ?
	3.	Comment Fail2Ban interagit avec iptables ?
	4.	Pourquoi bloquer Tor exit nodes peut Ãªtre pertinent ?
	5.	Que faut-il penser concernant IPv6 ?

â¸»

âœ… Cas dâ€™usage
	â€¢	Serveur SSH exposÃ© : limiter accÃ¨s SSH uniquement au rÃ©seau interne
	â€¢	Blocage dâ€™IP aprÃ¨s alertes de threat intelligence
	â€¢	Protection adaptative via Fail2Ban couplÃ©e Ã  UFW

â¸»

ğŸ”§ Extensions possibles
	â€¢	Automatiser le tÃ©lÃ©chargement et lâ€™injection dâ€™IP reputation
	â€¢	Mettre en place des rÃ¨gles de filtrage de sortie (egress filtering)  ï¿¼ ï¿¼ ï¿¼ ï¿¼ ï¿¼
	â€¢	ComplÃ©ter avec un IDS pour surveillance en profondeur ()

â¸»

ğŸ“ RÃ©sultat attendu
	â€¢	Serveur protÃ©gÃ© par rÃ¨gles UFW + Fail2Ban
	â€¢	Blocage statique (IP malveillantes) + blocage dynamique (tentatives infructueuses)
	â€¢	Logs activÃ©s pour vÃ©rification et audit

ğŸ”š Vous disposez dÃ©sormais dâ€™une base solide pour sÃ©curiser efficacement vos machines Linux contre des menaces rÃ©seau courantes.

