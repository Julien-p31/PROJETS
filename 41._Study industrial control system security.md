# Tutoriel : SÃ©curiser les systÃ¨mes de contrÃ´le industriel (ICS/SCADA)

## ğŸ¯ Objectif  
Comprendre lâ€™architecture ICS, identifier les vulnÃ©rabilitÃ©s spÃ©cifiques, mettre en place des mesures de dÃ©fense (segmentation, IAM, IDS/OTXâ€¦) et tester les contre-mesures en environnement simulÃ©.

## ğŸ§  ScÃ©nario dâ€™ancrage Ã©motionnel  
Vous Ãªtes ingÃ©nieur dans une usine connectÃ©e. Un attaquant pourrait manipuler clandestinement les automates industriels (PLC/RTU) via une console HMI piratÃ©e. Votre missionâ€¯: dÃ©fendre le systÃ¨me pour prÃ©server la production et la sÃ©curitÃ© humaine.

---

## ğŸ› ï¸ PrÃ©requis  
- Environnement Linux + VM/PC Windows  
- Simples outils : Docker, Wireshark, nmap  
- Simulateur ICS : PLC-SIM de Siemens ou SCADAhoney  
- Documentation ICS/Cyber : NIST SPâ€¯800â€‘82, IEC62443

---

## ğŸ§© Ã‰tapeâ€¯1 â€“ Comprendre lâ€™architecture ICS

- Composants clÃ©sâ€¯: capteurs/actuateurs (niv0), PLC/RTU (niv1), HMI/SCADA/DCS (niv2-3), IT/Entreprise (niv4-5)   
- Cartographiez un schÃ©ma simple (HMI â†” PLC â†” capteur) isolÃ© du rÃ©seau IT 

---

## ğŸ§© Ã‰tapeâ€¯2 â€“ Identifier les vecteurs dâ€™attaque

- Interfaces HMI accessibles (USB, login) peuvent Ãªtre usurpÃ©es   
- Redes IoT/faible authentification, firmware non patchÃ©  
- Movement latÃ©ral depuis IT (VPN, partages non segmentÃ©s) 

---

## ğŸ”’ Ã‰tapeâ€¯3 â€“ Segmentation et contrÃ´le des accÃ¨s

- Mettez en place un DMZ ; isolez rÃ©seau ICS-IP vs rÃ©seau entreprise   
- ImplÃ©mentez contrÃ´le des accÃ¨s basÃ©s sur les rÃ´les (IAM pour HMI/Engineering)  
- Appliquez un modÃ¨le Zero-Trust (authentification par device, micro-segmentation) 

---

## ğŸ§© Ã‰tapeâ€¯4 â€“ Durcissement & surveillance

- DÃ©sactivez USB non essentiels, verrous sur les interfaces HMI  
- Utilisez des whitelists dâ€™applications sur les stations SCADA  
- DÃ©ployez un IDS spÃ©cialiste ICS (ex. Zeek + signatures de protocoles SCADA)
- Ã‰tablissez une baseline rÃ©seau et dÃ©tectez toute anomalie 

---

## ğŸ§© Ã‰tapeâ€¯5 â€“ RÃ©aliser un test dâ€™intrusion simulÃ©

1. Clonez un simulateur ICS (ex. SCADAhoney ou PLC-SIM dans une VM)  
2. Scannez le rÃ©seau ICS :
   ```bash
   nmap -sS -p 502,20000 <IP_PLC>

	3.	Utilisez Metasploit avec module plc/omron/siemens ou modbus pour tentative de connexion:

use auxiliary/scanner/plc/siemens_s7_connect
set RHOSTS <IP_PLC>
run


	4.	Analysez les logs Wireshark pour voir les requÃªtes Modbus/S7 (analyse via tcp.port==502)

â¸»

ğŸ§  Ã‰tapeâ€¯6 â€“ Protection & remÃ©diation
	â€¢	Activez authentification forte sur PLC/HMI
	â€¢	Mettez Ã  jour firmware avec correctifs et dÃ©sactivez comptes par dÃ©faut
	â€¢	Appliquez firewall ICS/OT ; refus de trafic inattendu
	â€¢	Surveillez continuellement les communications non conformes

â¸»

ğŸ§ª Quiz de consolidation
	1.	Quels sont les niveaux du modÃ¨le Purdue ICS ?
	2.	Pourquoi segmenter rÃ©seau IT/OT ?
	3.	Quel port scanne Metasploit sur un PLC Siemens ?
	4.	Quâ€™indique un paquet Modbus anormal ?
	5.	Quelle mesure prÃ©vient lâ€™accÃ¨s USB non autorisÃ© ?

â¸»

âœ… Cas dâ€™usage
	â€¢	Usine automatisÃ©e, raffinerie, water plant
	â€¢	DÃ©ploiement dâ€™IDS + segmentation entre Enterprise & OT
	â€¢	Simulations de scÃ©nario Ã©lÃ©ments compromis via SCADAhoney

â¸»

ğŸ”§ Extensions possibles
	â€¢	Automatiser le scanning Modbus et alertes via Python
	â€¢	IntÃ©grer MISP & signature de menaces ICS dans un SIEM (Splunk/Elastic)
	â€¢	Ajouter fuzzing sur interfaces SCADA (OPC UA, DNP3)
	â€¢	Adopter IECâ€¯62443 & NIST SPâ€¯800â€‘82 comme cadre rÃ©glementaire

â¸»

ğŸ“ RÃ©sultat attendu
	â€¢	Architecture ICS cartographiÃ©e et segmentÃ©e
	â€¢	Test dâ€™intrusion dÃ©tectÃ© et bloquÃ©
	â€¢	Baseline rÃ©seau et alertes configurÃ©es
	â€¢	Plans de remÃ©diation robuste, conformitÃ© ICS assurÃ©e

---

### ğŸ“š RÃ©fÃ©rences utiles  
- NIST SPâ€¯800â€‘82 guide ICS/SCADA   
- CIS Controls ICS Focus: segmentation IT/OT   
- CISA ICS best practices & formation gratuite   
- Approche Zeroâ€‘Trust dans les environnements OT 

---