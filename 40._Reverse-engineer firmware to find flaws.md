# Tutoriel : RÃ©troâ€‘ingÃ©nierie de firmware pour dÃ©tecter des vulnÃ©rabilitÃ©s

## ğŸ¯ Objectif  
Extraire, analyser et Ã©muler un firmware IoT/embarquÃ© pour y dÃ©couvrir des vulnÃ©rabilitÃ©s (buffer overflow, backdoors, key leaksâ€¦), Ã  lâ€™aide dâ€™outils gratuits et en 1 journÃ©e.

## ğŸ§  ScÃ©nario dâ€™ancrage  
Un client dÃ©couvre que sa camÃ©ra IP transmet tout en clair. Vous devez rÃ©cupÃ©rer le firmware, lâ€™analyser et vÃ©rifier la prÃ©sence de clÃ©s embarquÃ©es ou dâ€™authentifications faibles.

---

## ğŸ› ï¸ PrÃ©requis  
- Linux (Ubuntu 22.04+)  
- Outils Ã  installer :
  ```bash
  sudo apt update
  sudo apt install binwalk qemu git build-essential
  pip install angr radare2

	â€¢	Firmware cible (ex. .bin) soit tÃ©lÃ©chargÃ© depuis le site du fabricant, soit extrait via MITM, JTAG ou dumping SPI  ï¿¼ ï¿¼ ï¿¼

â¸»

ğŸ§© Ã‰tapeâ€¯1 â€“ Acquisition du firmware

PossibilitÃ©s :
	1.	TÃ©lÃ©charger depuis le site officiel
	2.	Intercepter une mise Ã  jour OTA (MITM proxy) ()
	3.	Faire un dump SPI via BusPirate/Flashrom  ï¿¼

â¸»

ğŸ§© Ã‰tapeâ€¯2 â€“ Extraction & inspection

binwalk -e firmware.bin                 # extraction initiale
binwalk -Me firmware.bin               # extraction rÃ©cursive
cd _firmware.bin.extracted
file *                                 # inspect file system, kernel, clÃ©s...

	â€¢	Cherchez des fichiers sensibles : .pem, .db, passwd ()

â¸»

ğŸ§© Ã‰tapeâ€¯3 â€“ Analyse statique
	1.	Utilisez file et strings pour identifier binaires ARM/MIPS
	2.	DÃ©compilez/dÃ©sassemblez avec radare2 ou objdump :

r2 -A binary
iij     # infos initiales
aaa     # analyse
pdf @ sym.main


	3.	Utilisez angr pour dÃ©tecter des chemins vulnÃ©rables (buffer overflowâ€¦)  ï¿¼

â¸»

ğŸ§© Ã‰tapeâ€¯4 â€“ Ã‰mulation & dynamique
	1.	Montez lâ€™img FS si possible (mount -o loop)
	2.	PrÃ©parez une VM QEMU avec le kernel et FS extrait
	3.	Lancez :

qemu-system-arm \
  -M vexpress-a9 \
  -kernel vmlinuz-xxx \
  -drive if=sd,file=rootfs.img \
  -append "root=/dev/mmcblk0"


	4.	ExÃ©cutez interactivement les binaires extraits

â¸»

ğŸ” Ã‰tapeâ€¯5 â€“ Recherche de vulnÃ©rabilitÃ©s
	â€¢	Fuzz au niveau FS ou API locales (ex. HTTP local)
	â€¢	Utilisez Î¼AFL/un hardware-fuzzing pour dÃ©couvrir RCE  ï¿¼ ï¿¼
	â€¢	Exemple : fuzz dâ€™un utilitaire dâ€™authentification interne

â¸»

ğŸ§  Ã‰tapeâ€¯6 â€“ Documentation & rapport
	1.	Listez clÃ©s trouvÃ©es, binaires suspects, fichiers de config
	2.	Documentez chemins vulnÃ©rables avec captures angr/QEMU
	3.	Proposez remÃ©diations (chiffrement, CVE report, patch)

â¸»

ğŸ§ª Quiz de consolidation
	1.	Quels moyens utiliser pour obtenir un firmware ?
	2.	Pourquoi binwalk -Me estâ€‘il recommandÃ© ?
	3.	Quand prÃ©fÃ¨reâ€‘tâ€‘on angr Ã  QEMU ?
	4.	Quels fichiers sensibles chercheâ€‘tâ€‘on dans le firmware ?
	5.	Quelle mÃ©thode sÃ©curise lâ€™exÃ©cutable dans QEMU ?

â¸»

âœ… Cas dâ€™usage
	â€¢	Audit camÃ©ra IP, routeur, firmware niche
	â€¢	DÃ©tection de clÃ©s embarquÃ©es ou backdoors logicielles
	â€¢	Analyse de mise Ã  jour OTA ou VA vulnÃ©rables
	â€¢	Preuve de concept exploit via fuzzing intÃ©grÃ©

â¸»

ğŸ”§ Extensions possibles
	â€¢	Automatiser pipeline extraction/analyse avec scripts Python
	â€¢	IntÃ©grer Firmadyne + Firmwalker pour analyses vastes
	â€¢	Connexion Ã  buildroot pour recompiler un FS sÃ©curisÃ©
	â€¢	GÃ©nÃ©rer patch et signaler au fabricant

â¸»

ğŸ“ RÃ©sultat attendu
	â€¢	Firmware extrait, inspectÃ©, Ã©muluÃ©
	â€¢	VulnÃ©rabilitÃ©s identifiÃ©es (ex. clÃ©s, overflow, RCE)
	â€¢	Rapport clair, reproductible, avec PoC dâ€™exploitation

---

### ğŸ“š Sources principales  
- Guide firmware reverse-engineering (Infosec Institute)  [oai_citation:7â€¡Infosec Institute](https://www.infosecinstitute.com/resources/iot-security/iot-security-fundamentals-reverse-engineering-firmware/?utm_source=chatgpt.com) [oai_citation:8â€¡ivanorsolic.github.io](https://ivanorsolic.github.io/post/hardwarehacking1/?utm_source=chatgpt.com) [oai_citation:9â€¡Toolify](https://www.toolify.ai/gpts/mastering-firmware-analysis-iot-reverse-engineering-126609?utm_source=chatgpt.com) [oai_citation:10â€¡NSE Lab](https://nse.digital/pages/guides/firmware/firmware_hacking.html?utm_source=chatgpt.com)  
- Outils & mÃ©thodologie (NSE Lab)  [oai_citation:11â€¡NSE Lab](https://nse.digital/pages/guides/firmware/firmware_hacking.html?utm_source=chatgpt.com)  
- DÃ©monstration pratique (Binwalk, QEMU)  [oai_citation:12â€¡Infosec Institute](https://www.infosecinstitute.com/resources/iot-security/iot-security-fundamentals-reverse-engineering-firmware/?utm_source=chatgpt.com)  
- Fuzz firmware & Î¼AFL (IoT microcontroller)  [oai_citation:13â€¡arxiv.org](https://arxiv.org/abs/2202.03013?utm_source=chatgpt.com)  
- Analyse binaire avec angr, radare2  [oai_citation:14â€¡NSE Lab](https://nse.digital/pages/guides/firmware/firmware_hacking.html?utm_source=chatgpt.com)  
- SchÃ©mas de reverse-engineering logiciel  [oai_citation:15â€¡EDUCBA](https://www.educba.com/reverse-engineering/?utm_source=chatgpt.com)  
