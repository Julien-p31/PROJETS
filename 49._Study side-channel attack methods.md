# Tutoriel : Comprendre et exploiter les attaques par canaux auxiliaires (side-channel)

## ğŸ¯ Objectif  
Identifier, reproduire et contrer plusieurs techniques dâ€™attaques par canaux auxiliaires (temps, cache, puissance, Ã©lectromagnÃ©tique, DMAâ€¦) dans un environnement sÃ©curisÃ©.

## ğŸ§  ScÃ©nario Ã©motionnel  
Un attaquant espionne les calculs dâ€™une clÃ© AES sur un module hardware via des signaux matÃ©riels non protÃ©gÃ©s. Vous devez dÃ©montrer et signaler ces failles avant exploitation en production.

---

## ğŸ› ï¸ PrÃ©requis  
- Linux + accÃ¨s root  
- MicrocontrÃ´leur ou module TPM simulÃ©  
- Outilsâ€¯: oscilloscope logique ou simulateur (sigrok), script Python, `cachetools`  
- Librairies Python : `numpy`, `scipy`, `scapy`  
- Variante protÃ©gÃ©e et non protÃ©gÃ©e pour comparaison  

---

## ğŸ§© Ã‰tapeâ€¯1 â€“ Fondamentaux et typologies

- Une attaque par canal auxiliaire cible les fuites physiques (temps, puissance, EM, sonâ€¦) de lâ€™implÃ©mentation, pas lâ€™algorithme ()  
- Principaux vecteurs :
  1. Temps dâ€™exÃ©cution
  2. Cache timing (Flush+Reload, Prime+Probe, Demote+Reload)  [oai_citation:0â€¡Comparitech](https://www.comparitech.com/blog/information-security/side-channel-attack/?utm_source=chatgpt.com) [oai_citation:1â€¡Wikipedia](https://en.wikipedia.org/wiki/Cache_timing_attack?utm_source=chatgpt.com)  
  3. Analyse de puissance : SPA / DPA / CPA  [oai_citation:2â€¡All About Circuits](https://www.allaboutcircuits.com/technical-articles/a-basic-introduction-to-power-based-side-channel-attacks/?utm_source=chatgpt.com)  
  4. Ã‰missions Ã©lectromagnÃ©tiques (SEMA/DEMA)  [oai_citation:3â€¡Wikipedia](https://en.wikipedia.org/wiki/Electromagnetic_attack?utm_source=chatgpt.com)  
  5. Attaques DMA (bus Thunderboltâ€¦) ()  
  6. Throttling de frÃ©quence comme canal temporel ()

---

## ğŸ” Ã‰tapeâ€¯2 â€“ Timing attack DIY

```python
import time
def encrypt(x): ...
for guess in range(256):
  t0 = time.time()
  encrypt_with_key_guess(guess)
  t1 = time.time()
  print(guess, t1-t0)

â†’ diffÃ©rences de t1 - t0 permettent de cibler la bonne clÃ© ()

â¸»

ğŸ§© Ã‰tapeâ€¯3 â€“ Cache timing attack : Flush+Reload
	1.	Flush ligne cache : clflush en code C ou assembleur.
	2.	Mesurez le temps de reload aprÃ¨s exÃ©cution de la cible.
	3.	CorrÃ©lez les temps avec les accÃ¨s mÃ©moire : rÃ©cupÃ©ration de bits secrets ()

â¸»

ğŸ”Œ Ã‰tapeâ€¯4 â€“ Power analysis (SPA/DPA)
	â€¢	Capture de la consommation via oscilloscope
	â€¢	SPAâ€¯: analyse visuelle des pics
	â€¢	DPA : collecte plusieurs traces et statistiques  ï¿¼

# pseudo-code : corrÃ©lation entre hypothÃ¨se de bit et consommation


â¸»

ğŸ§² Ã‰tapeâ€¯5 â€“ Electromagnetic attack
	â€¢	Utilisez une sonde EM proche du module
	â€¢	SEMA : trace EM visuelle
	â€¢	DEMA : traitement statistique de plusieurs traces  ï¿¼ ï¿¼

â¸»

ğŸ”Œ Ã‰tapeâ€¯6 â€“ DMA attack test
	â€¢	Connectez via Thunderbolt ou FireWire Ã  une VM vulnÃ©rable
	â€¢	Utilisez inetsim pour simuler la exfiltration via DMA  ï¿¼

â¸»

ğŸ§  Ã‰tapeâ€¯7 â€“ Frequency-throttling timing attack
	â€¢	Forcez la charge du CPU pour activer le throttling
	â€¢	Mesurez les variations temporelles dâ€™un chiffrement constant  ï¿¼

â¸»

ğŸ” Ã‰tapeâ€¯8 â€“ Contre-mesures avancÃ©es

Technique	Contre-mesure
Timing	algorithmes constant-time  ï¿¼
Cache	partitionnement, flush, bruit ()
Power	masquage, Ã©galisation de puissance ()
EM	blindage Faraday ()
DMA	dÃ©sactiver ports DMA non nÃ©cessaires ()
Throttling	limiter les fluctuations via limites OS/BIOS


â¸»

ğŸ§ª Quiz de consolidation
	1.	Quelle diffÃ©rence entre SPA et DPAâ€¯?
	2.	Comment fonctionne un Flush+Reloadâ€¯?
	3.	Pourquoi le cache est exploitableâ€¯?
	4.	Ã€ quoi sert le masquage dans lâ€™analyse de puissanceâ€¯?
	5.	Quelle attaque exploite un port FireWireâ€¯?

â¸»

âœ… Cas dâ€™usage
	â€¢	Audit de module TPM/Smartcard
	â€¢	Validation de code cryptographique embarquÃ©
	â€¢	Certification matÃ©riel selon standard CC EAL

â¸»

ğŸ”§ Extensions possibles
	â€¢	ImplÃ©menter en Rust un cache partitionnÃ© constant-time
	â€¢	Automatiser collecte de traces EM + analyse DPA
	â€¢	Simuler attaque cross-core sur VM via Prime+Probe
	â€¢	CrÃ©er une suite dâ€™analyse multi-vecteurs (power, EM, timing)

---

### ğŸ“š RÃ©fÃ©rences clÃ©s  
- DÃ©finition & implications des attaques par canal auxiliaire  [oai_citation:10â€¡All About Circuits](https://www.allaboutcircuits.com/technical-articles/a-basic-introduction-to-power-based-side-channel-attacks/?utm_source=chatgpt.com) [oai_citation:11â€¡NDSS Symposium](https://www.ndss-symposium.org/wp-content/uploads/2025-253-paper.pdf?utm_source=chatgpt.com) [oai_citation:12â€¡Infosec Institute](https://www.infosecinstitute.com/resources/hacking/what-is-a-side-channel-attack/?utm_source=chatgpt.com) [oai_citation:13â€¡ResearchGate](https://www.researchgate.net/figure/The-experimental-schemes-for-side-channel-attack_fig3_275406106?utm_source=chatgpt.com) [oai_citation:14â€¡- WNE Security](https://wnesecurity.com/understanding-side-channel-attacks-how-hackers-exploit-indirect-data-leaks/?utm_source=chatgpt.com)  
- Analyse cache avancÃ©e : Flush+Reload, Demote+Reloadâ€¦  [oai_citation:15â€¡NDSS Symposium](https://www.ndss-symposium.org/wp-content/uploads/2025-253-paper.pdf?utm_source=chatgpt.com)  
- Power side-channel : SPA/DPA, masquage, blinding  [oai_citation:16â€¡Wikipedia](https://en.wikipedia.org/wiki/Cache_timing_attack?utm_source=chatgpt.com)  
- Attaques EM (SEMA/DEMA) + preuve Ã  distance ()  
- DMA & frequency throttling cÃ´tÃ©s OS  [oai_citation:17â€¡arXiv](https://arxiv.org/abs/2206.07012?utm_source=chatgpt.com)  

