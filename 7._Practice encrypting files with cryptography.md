# Tutoriel : Chiffrer et dÃ©chiffrer des fichiers (pratique)

## ğŸ¯ Objectif  
CrÃ©er un script Python simple pour chiffrer/dÃ©chiffrer un fichier en utilisant AES symÃ©trique (via `Fernet`).

## ğŸ§  ScÃ©nario dâ€™ancrage Ã©motionnel  
Imaginez que vous devez protÃ©ger un document confidentiel avant de lâ€™envoyer Ã  un collÃ¨gue. Vous sÃ©curisez vos donnÃ©es avec un mot de passe fort et faites une dÃ©monstration en direct du chiffrement.

---

## ğŸ› ï¸ PrÃ©requis  
- Linux (Ubuntu/Debian) ou VM  
- Pythonâ€¯3.7+  
- Installer la librairie crypto :
  ```bash
  pip install cryptography


â¸»

Ã‰tape 1 â€“ GÃ©nÃ©rer et sauvegarder une clÃ©

from cryptography.fernet import Fernet

def generate_key(path="secret.key"):
    key = Fernet.generate_key()
    with open(path, "wb") as f:
        f.write(key)
    print(f"ğŸ”‘ ClÃ© gÃ©nÃ©rÃ©e dans {path}")


â¸»

Ã‰tape 2 â€“ Chiffrer un fichier

def encrypt_file(file_path, key_path="secret.key", out_path=None):
    if out_path is None:
        out_path = f"{file_path}.enc"

    with open(key_path, "rb") as kf:
        key = kf.read()
    cipher = Fernet(key)

    with open(file_path, "rb") as f:
        data = f.read()
    token = cipher.encrypt(data)

    with open(out_path, "wb") as wf:
        wf.write(token)
    print(f"âœ… Fichier chiffrÃ© : {out_path}")


â¸»

Ã‰tape 3 â€“ DÃ©chiffrer un fichier

def decrypt_file(enc_path, key_path="secret.key", out_path=None):
    if out_path is None and enc_path.endswith(".enc"):
        out_path = enc_path[:-4]
    elif out_path is None:
        out_path = f"{enc_path}.dec"

    with open(key_path, "rb") as kf:
        key = kf.read()
    cipher = Fernet(key)

    with open(enc_path, "rb") as ef:
        token = ef.read()
    data = cipher.decrypt(token)

    with open(out_path, "wb") as wf:
        wf.write(data)
    print(f"ğŸ”“ Fichier dÃ©chiffrÃ© : {out_path}")


â¸»

Ã‰tape 4 â€“ Script CLI basique

import argparse

def main():
    parser = argparse.ArgumentParser(description="Chiffrement symÃ©trique de fichiers")
    sub = parser.add_subparsers(dest="cmd", required=True)

    g = sub.add_parser("key").add_argument("--out", "-o", help="Chemin clÃ©")
    e = sub.add_parser("enc")
    e.add_argument("infile")
    e.add_argument("-k", "--key", default="secret.key")
    d = sub.add_parser("dec")
    d.add_argument("infile")
    d.add_argument("-k", "--key", default="secret.key")

    args = parser.parse_args()
    if args.cmd == "key":
        generate_key(args.out or "secret.key")
    elif args.cmd == "enc":
        encrypt_file(args.infile, args.key)
    else:
        decrypt_file(args.infile, args.key)

if __name__ == "__main__":
    main()


â¸»

ğŸ§© Analogies & piÃ¨ges Ã  Ã©viter
	â€¢	ClÃ© secrÃ¨te = empreinte inviolable
	â€¢	âš ï¸ Stocker la secret.key de maniÃ¨re sÃ©curisÃ©e
	â€¢	â™»ï¸ Si clÃ© perdue, fichiers chiffrÃ©s sont irrÃ©cupÃ©rables
	â€¢	âœ… Utiliser Fernet (AESâ€‘128+HMAC) pour intÃ©gritÃ© et confidentialitÃ©  ï¿¼ ï¿¼ ï¿¼

â¸»

ğŸ§ª Quiz
	1.	Pourquoi chiffrer donnÃ©es sensibles ?
	2.	Que contient secret.key ?
	3.	Que se passe-t-il si la clÃ© est corrompue ?
	4.	Pourquoi Fernet est sÃ©curisÃ© ?
	5.	Comment amÃ©liorer : mot de passe + dÃ©rivation de clÃ© (PBKDF2) ?

â¸»

âœ… Cas dâ€™usage
	â€¢	Chiffrement avant envoi (USB, mailâ€¦)
	â€¢	Sauvegarde de documents sensibles
	â€¢	Base pour automatisation ou GUI

â¸»

ğŸ”§ Extensions possibles
	â€¢	Utiliser PBKDF2HMAC pour dÃ©river la clÃ© depuis un mot de passe
	â€¢	Ajouter gestion dâ€™erreurs, prompts, rotation de clÃ©s
	â€¢	Packager en exÃ©cutable ou interface graphique avec PyQt

â¸»

ğŸ“ RÃ©sultat attendu

Un outil CLI en un seul fichier Python permettant de :
	â€¢	GÃ©nÃ©rer une clÃ©
	â€¢	Chiffrer et dÃ©chiffrer des fichiers
	â€¢	Comprendre les principes de chiffrement symÃ©trique

Sources principales :
- Tutoriel sur chiffrement fichier avec `cryptography.fernet`  [oai_citation:3â€¡codelucky.com](https://codelucky.com/python-cryptography/?utm_source=chatgpt.com) [oai_citation:4â€¡newsletter.hackr.io](https://newsletter.hackr.io/p/how-to-build-a-file-encryption-app-in-python?utm_source=chatgpt.com)  
- Bonnes pratiques et explications symÃ©trique AES, intÃ©gritÃ© via HMAC ()